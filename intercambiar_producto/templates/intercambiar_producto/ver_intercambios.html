{% extends "homepage/base.html" %}

{% block content %}
<div class="container">
  <h2 class="text-center">Solicitudes de Intercambio</h2>

  <div class="row">
    <div class="col-md-6">
      <h3>Solicitudes Enviadas</h3>
      <ul class="list-group">
        {% for solicitud in solicitudes_enviadas %}
          <li class="list-group-item">
            <strong>Producto Solicitante:</strong> {{ solicitud.producto_solicitante.nombre }} <br>
            <strong>Producto Receptor:</strong> {{ solicitud.producto_receptor.nombre }} <br>
            <strong>Estado:</strong> {{ solicitud.estado }} <br>
            <strong>Fecha de Solicitud:</strong> {{ solicitud.fecha_solicitud }} <br>
            <strong>Día:</strong> {{ solicitud.dia }} <br>
            <strong>Horario:</strong> {{ solicitud.horario }} hs<br>
            <strong>Sucursal:</strong> {{ solicitud.producto_solicitante.sucursal }} <strong>Ciudad:</strong> {{ solicitud.producto_solicitante.sucursal.ciudad }} <br>
            <form method="post" action="{% url 'ver_intercambios' %}" style="display:inline;">
              {% csrf_token %}
              <input type="hidden" name="intercambio_id" value="{{ solicitud.id }}">
              {% if solicitud.estado == 'pendiente' %}
                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('¿Estás seguro de que deseas cancelar esta solicitud?')">Cancelar Solicitud</button>
              {% endif %}
              </form>
          </li>
        {% empty %}
          <li class="list-group-item">No has enviado ninguna solicitud de intercambio.</li>
        {% endfor %}
      </ul>
    </div>

    <div class="col-md-6">
      <h3>Solicitudes Recibidas</h3>
      <ul class="list-group">
        {% for solicitud in solicitudes_recibidas %}
          <li class="list-group-item">
            <strong>Producto Solicitante:</strong> {{ solicitud.producto_solicitante.nombre }} <br>
            <strong>Producto Receptor:</strong> {{ solicitud.producto_receptor.nombre }} <br>
            <strong>Estado:</strong> {{ solicitud.estado }} <br>
            <strong>Fecha de Solicitud:</strong> {{ solicitud.fecha_solicitud }} <br>
            <strong>Día:</strong> {{ solicitud.dia }} <br>
            <strong>Horario:</strong> {{ solicitud.horario }} hs <br>
            <strong>Sucursal:</strong> {{ solicitud.producto_solicitante.sucursal }} <strong>Ciudad:</strong> {{ solicitud.producto_solicitante.sucursal.ciudad }} <br>
            <div class="btn-group" role="group" aria-label="Acciones">
              <a href="{% url 'ver_detalle' solicitud.id %}" class="btn btn-primary">Ver Detalle</a>
            </div>
          </li>
        {% empty %}
          <li class="list-group-item">No has recibido ninguna solicitud de intercambio.</li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>
{% endblock %}
